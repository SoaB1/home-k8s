- name: Configure requirements
  become: yes
  ansible.builtin.lineinfile:
    path: /etc/modules-load.d/containerd.conf
    line: {{ item }}
  with_items: 
    - 'overlay'
    - 'br_netfilter'
  shell: |
    modprobe overlay
    modprobe br_netfilter

- name: Configure Kernel
  become: yes
  ansible.builtin.lineinfile:
    path: /etc/sysctl.d/k8s.conf
    line: {{ item }}
  with_items: 
    - 'net.bridge.bridge-nf-call-iptables  = 1'
    - 'net.bridge.bridge-nf-call-ip6tables = 1'
    - 'net.ipv4.ip_forward                 = 1'